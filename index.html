<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Cloudmall Dictionary</title>
<script src="https://sdk.minepi.com/pi-sdk.js"></script>
</head>

<body style="font-family:Arial;text-align:center">

<h1>Cloudmall Dictionary</h1>

<input id="search" placeholder="ابحث عن كلمة" style="padding:10px;width:80%">
<div id="result"></div>

<button onclick="pay()" style="margin-top:20px;padding:12px 25px;background:green;color:white;border:none">
Pay 0.01 Pi
</button>

<script>
Pi.init({ version:"2.0", sandbox:true });

fetch("words.json")
.then(r=>r.json())
.then(words=>{
document.getElementById("search").oninput=(e)=>{
const q=e.target.value.toLowerCase();
const res=words.filter(w=>w.word.includes(q));
document.getElementById("result").innerHTML=res.map(w=>`<p>${w.word} = ${w.meaning}</p>`).join("");
}
})

async function pay(){
await Pi.createPayment({
  amount:0.01,
  memo:"Cloudmall Dictionary",
  metadata:{type:"test"}
},{
  onReadyForServerApproval: async (paymentId)=>{
    await fetch("/approve",{method:"POST"});
  },
  onReadyForServerCompletion: async (paymentId)=>{
    await fetch("/complete",{method:"POST"});
  },
  onCancel:(paymentId)=>{alert("cancel")},
  onError:(error)=>{alert(JSON.stringify(error))}
});
}
</script>

</body>
</html>
